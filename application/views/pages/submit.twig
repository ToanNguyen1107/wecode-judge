{#
 # Sharif Judge
 # file: submit.twig
 # author: Mohammad Javad Naderi <mjnaderi@gmail.com>
 #}
{% set selected = 'submit' %}
{% extends 'templates/base.twig' %}
{% block icon %}fa-location-arrow{% endblock %}
{% block title %}Submit{% endblock %}
{% block head_title %}Submit{% endblock %}



{% block other_assets %}
<script>
	shj.p={};
	{{ problems_js|raw }}

	$(document).ready(function(){
		$("select#problems").change(function(){
			var v = $(this).val();
			if (v==0)
				return;
			$('select#languages').empty();
			//$('<option value="0" selected="selected">-- Select Language --</option>').appendTo('select#languages');
			for (var i=0;i<shj.p[v].length;i++)
				$('<option value="'+shj.p[v][i]+'">'+shj.p[v][i]+'</option>').appendTo('select#languages');
		});

		{% if from == '' %}
			$("select#problems").val(1);
		{% else  %}
			$("select#problems").val({{ from }});
		{% endif %}
		$("select#problems").change();


	});
</script>

<style type="text/css" media="screen">
    #editor {
        position: relative;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
		width: 500px;
height: 400px;
    }
</style>
{% endblock %}



{% block main_content %}
{% if error != 'none' %}
<p>{{ error }}</p>
{% else %}
	<p>Selected assignment: <span dir="auto">{{ user.selected_assignment.name }}</span></p>
	<p>Coefficient: {{ coefficient }}%</p>
	{{ form_open_multipart('submit') }}
	<p class="input_p">
		<label for="problems" class="tiny">Problem:</label>
		<select id="problems" name ="problem" class="sharif_input">
			<!--option value="0" selected="selected">-- Select Problem --</option-->
			{% for problem in problems %}
				<option dir="auto" value="{{ problem.id }}">#{{problem.id}}--{{ problem.name }}</option>
			{% endfor %}
		</select>
		{{ form_error('problem','<div class="shj_error">','</div>') }}
	</p>
	<p class="input_p">
		<label for="languages" class="tiny">Language:</label>
		<select id="languages" name="language" class="sharif_input">
			<!--option value="0" selected="selected">-- Select Language --</option-->
		</select>
		{{ form_error('language','<div class="shj_error">','</div>') }}
	</p>
	<!--p class="input_p">
		<label for="file" class="tiny">File:</label>
		<input type="file" id="file" class="sharif_input medium" name="userfile" />
		{% if upload_state == 'error' %}
		<div class="shj_error">Error uploading file.</div>
		{% elseif upload_state == 'ok' %}
		<div class="shj_ok">File uploaded successfully. See the result in 'All Submissions'.</div>
		{% endif %}
	</p-->

	<p class="input_p">
		<label for="code" class="tiny">Code:</label>
		<textarea  style="display:none;" rows="4" cols="80" name="code" class="sharif_input add_text">
		</textarea>
	</p>
	<div id="editor">//Paste your code here
//NOTE: If you use java, your Main class must be named solution</div>
	<p class="input_p">
		<input type="submit" value="Submit" class="sharif_input"/>
	</p>
	</form>
	<script src="{{ base_url('assets/js/src-min-noconflict/ace.js') }}" type="text/javascript" charset="utf-8"></script>
	<script  type="text/javascript" charset="utf-8">
		var editor = ace.edit("editor");
		editor.setTheme("ace/theme/dawn");
		editor.session.setMode("ace/mode/c_cpp");
		$("form").submit(function(){
			$("textarea").val(editor.getSession().getValue());
		});

		$("select[name=language]").change(function(){
			var lang_to_mode = {"C++":"c_cpp"
				, Java:"java"
				, "Python 2":"python"
				, "Python 3":"python"
			};
			editor.session.setMode("ace/mode/" + lang_to_mode[$(this).val()]);
		});
	</script>
{% endif %}
{% endblock %}  {# main_content #}
